# Проект Mesto React-Express

**Демонстрация проекта на [Яндекс.Облако](https://cloud.yandex.ru/): [Mesto React-Express](https://maxsin.students.nomoreparties.co)**

**Сервер с API расположен по адресу - https://api.maxsin.students.nomoreparties.co**

## :page_with_curl: Описание проекта

Финальная работа по проекту `Mesto`. Внутри этого репозитория присутствуют front-end и back-end части приложения. Front-end часть является сборкой встроенного Webpack'a из репозитория [React-Mesto-Auth](https://github.com/MaximSinyukov/react-mesto-auth). А back-end часть является улучшенной версией проекта [Mesto-Express](https://github.com/MaximSinyukov/express-mesto).

## :book: Суть проекта

Проект позволяет создавать уникального пользователя. Дает возможность пользоваться сайтом без постоянных регистраций/авторизаций. Позволяет делиться фотокарточками с другими пользователями и ставить лайки к ним. Существует возможность редактирования данных пользователя через клик по аватарке или кнопку с карандашиком. Информация на сайте защищена от неавторизованных пользователей.

Вторая часть проекта позволяет развернуть `REST API` и задействовать базу данных `MongoDB`. Отличие этой версии бэкенд проекта в том, что:
- настроен сбор логов от входящих запросов и полученных ошибок через библиотеку `winston`
- все роуты, кроме регистрации и авторизации пользователя, защищены мидлвэрой `auth`, которая проверяет запрос на наличие токена
- все поля запроса валидируются до передачи в контроллеры при помощи `Joi` и `celebrate`
- `id` пользователя присваивается из обработки токена
- `JWT` токен действителен в течение недели
- пришедший пароль хешируется через `bcryptjs` перед добавлением в базу
- настроен централизованный обработчик ошибок, в него поступают ошибки из блоков `catch`
- перед удалением карточки происходит проверка владельца и отправителя запроса

## :pushpin: Приложение к API

В заголовках запросов к защищенным роутам следует обязательно добавить - `authorization: 'Bearer token'`, где `token` - это токен пользователя.

### :green_book: Открытые роуты

`POST /signup`  
Регистрация пользователя. В body необходимо передать объект с `email, password`. 
Возвращает объект пользователя c `email`.

`POST /signin`  
Регистрация пользователя. В body необходимо передать объект с `email, password`. 
Возвращает объект c `token`.

### :closed_book: Роуты с проверкой токена

`GET /users/me`  
Получение информации о пользователе.
Возвращает объект пользователя c `name, about, avatar`,где:
- `name` - имя пользователя
- `about` - деятельность или профессия пользователя
- `avatar` - ссылка на аватарку пользователя

`PATCH /users/me`  
Обновление данных пользователя. В body необходимо передать объект с `name, about`.
Возвращает объект пользователя c `name, about, avatar`.

`PATCH /users/me/avatar`  
Обновление аватара пользователя. В body необходимо передать объект с `avatar`, где `avatar` - это ссылка на картинку.
Возвращает объект пользователя c `name, about, avatar`.

`GET /cards`  
Получение карточек пользователя.
Возвращает массив c карточками. Карточки состоят из `likes, _id, name, link, owner`, где:
- `likes` - массив с пользовательскими id
- `_id` - id карточки
- `name` - название карточки
- `link` - ссылка на фото карточки
- `owner` - id пользователя создавшего карточку

`POST /cards`  
Создание карточки пользователя. В body необходимо передать `name, link`.
Возвращает карточку с информацией о ней.

`DELETE /cards/:id`  
Удаление карточки пользователя, где `id` - это id карточки.
Возвращает информацию об удаленной карточке.

`PUT /cards/likes/:id`  
Добавление лайка у карточки, где `:id` - это id карточки.
Возвращает карточку с обновленным массивом лайков.

`DELETE /cards/likes/:id`  
Удаление лайка у карточки, где `:id` - это id карточки.
Возвращает карточку с обновленным массивом лайков.

## :wrench: О работе с проектом

1. Перед работой установите необходимые зависимости через - `npm install`
2. Для локального запуска базы данных используйте - `mongod`
3. Для запуска API в режиме разработчика используйте - `npm run dev`
4. Для локального запуска API воспользуйтесь - `npm run start`

## :bookmark_tabs: Стек

- JavaScript
- NodeJS
- ExpressJS
- MongoDB
- Eslint
- Webpack
- HTML
- CSS

## :mag_right: Полученные навыки

* настройка сбора логов для входящих запросов и полученных ошибок
* защита некоторых роутов через мидлвэр
* валидация полей до передачи в контроллеры
* работа с генерацией токена
* хеширование пароля
* работа с централизованным обработчиком ошибок
* защита карточек от удаления другими пользователями
* подключение и работа с линтером
* запуск сервера на локальном порте
* реализация режима разработчика с хот релоудом
* настройка первых роутов
* подключение к MongoDB
* создание схем и моделей сущностей
* настройка базы данных
* создание и настройка роутов
* создание и настройка контроллеров
* использование готовой сборки из Webpack